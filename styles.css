/* Core theme variables */
:root{
  --bg:#0A0C10;
  --card:#11151C;
  --ink:#E8ECEF;
  --muted:#98A2B3;
  --up:#00C853;
  --down:#FF3B30;
  --accent:#F5C451;
  --grid-gap: clamp(12px, 2.4vw, 24px);
}
*{box-sizing:border-box}
html,body{height:100%; overflow-x:hidden}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  display:flex; flex-direction:column; min-height:100vh;
  font-variant-numeric: tabular-nums; text-rendering: optimizeLegibility;
}
html{scrollbar-width: none}
html::-webkit-scrollbar{display:none}
.app{display:flex; flex-direction:column; min-height:100vh}
header{
  display:flex; align-items:center; justify-content:space-between;
  padding: clamp(12px, 2vw, 18px) clamp(14px, 3vw, 28px);
  border-bottom: 1px solid rgba(255,255,255,.06);
  background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,0));
  position:sticky; top:0; z-index:2;
}
.mood-bar{height:4px; width:100%; background:linear-gradient(90deg, rgba(255,59,48,.25), rgba(0,200,83,.25)); position:sticky; top:56px; z-index:2}
.mood-bar::after{content:""; display:block; height:100%; width:var(--mood,50%); background:linear-gradient(90deg, rgba(255,59,48,.5), rgba(0,200,83,.5)); transition:width .6s ease}
.brand{display:flex; gap:12px; align-items:center}
.logo{
  width:34px; aspect-ratio:1; border-radius:8px;
  background: radial-gradient(120% 120% at 0% 0%, var(--accent), transparent),
              linear-gradient(135deg, #1f2430 0%, #0d1117 70%);
  box-shadow: 0 10px 30px rgba(245,196,81,.2), inset 0 0 0 1px rgba(255,255,255,.05);
}
.brand h1{font-size: clamp(16px, 2.4vw, 22px); margin:0; letter-spacing:.5px}
.sub{color:var(--muted); font-size: clamp(11px, 1.4vw, 13px)}
.controls{display:flex; gap:10px; align-items:center}
/* Range selector */
.range{display:inline-flex; gap:6px; background:#0d121a; border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:4px}
.range .rg{all:unset; cursor:pointer; padding:6px 8px; border-radius:8px; color:#cbd5e1}
.range .rg[aria-pressed="true"]{background:#223047; color:#e6eef9}
.range .rg:hover{background:#1a2536}
.sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
.net{display:inline-flex; align-items:center; gap:8px}
.dot{width:10px; height:10px; border-radius:999px; background:#8892a6; box-shadow:0 0 0 1px rgba(255,255,255,.15) inset, 0 0 0 0 rgba(0,200,83,0); animation: netPulse 2.2s ease-out infinite}
.dot.ok{background:#00C853}
.dot.err{background:#FF3B30}
@keyframes netPulse{0%{box-shadow:0 0 0 0 rgba(0,200,83,.0)}50%{box-shadow:0 0 0 8px rgba(0,200,83,.08)}100%{box-shadow:0 0 0 0 rgba(0,200,83,0)}}
@media (prefers-reduced-motion: reduce){.dot{animation:none}}
.version{padding:6px 10px; border-radius:999px; background:#0d121a; color:#cbd5e1; font-size:12px; font-weight:700; letter-spacing:.4px}
button{all:unset; cursor:pointer; padding:10px 14px; border-radius:12px; background:#1a202c; color:#e6e6e6; font-weight:600}
button:hover{background:#232b3a}
.controls button[aria-pressed="true"]{background:#223047}
.intensity{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; background:#0d121a; border-radius:12px}
.intensity input[type="range"]{width:100px}
.intensity span{color:#cbd5e1}
.grid{
  display:grid; gap: var(--grid-gap);
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  padding: var(--grid-gap);
  width:100%; flex:1; align-content:start;
}
.tile{
  background: var(--card); border-radius:18px; padding:18px; position:relative;
  box-shadow: 0 8px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.04);
  display:flex; flex-direction:column; gap:14px; min-height: 220px;
}
.tile.clickable{cursor:pointer}
.tile.clickable:hover{filter:brightness(1.02)}
.row{display:flex; align-items:center; justify-content:space-between; gap:12px; min-width:0}
.row, .id, .trade{min-width:0}
.row-tight{gap:10px; flex-wrap: wrap; align-items:flex-end; min-width:0}
.align-end{align-items:flex-end}
.tile .row > .row{min-width:0}
.id{display:flex; align-items:center; gap:10px}
.pair{min-width:0; overflow:hidden; text-overflow:ellipsis; display:block}
.aud-btn{all:unset; cursor:pointer; background:#0d121a; color:#cbd5e1; padding:4px 6px; border-radius:8px; font-size:12px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06)}
.aud-btn[aria-pressed="true"]{background:#223047}
.solo-btn{all:unset; cursor:pointer; background:#0d121a; color:#cbd5e1; padding:4px 6px; border-radius:8px; font-size:12px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06)}
.solo-btn[aria-pressed="true"]{background:#2a2d3a; color:#9ee493}
.tile.solo{outline:2px solid rgba(158,228,147,.35)}
.mini-dot{width:6px; height:6px; border-radius:999px; background:#243040; box-shadow:0 0 0 0 rgba(153,246,228,0);}
.mini-dot.ping{background:#99f6e4; box-shadow:0 0 0 8px rgba(153,246,228,.0); animation: dotPing .8s ease-out}
@keyframes dotPing{0%{box-shadow:0 0 0 0 rgba(153,246,228,.25)}100%{box-shadow:0 0 0 8px rgba(153,246,228,0)}}
.ticker{font-size: clamp(18px, 4vw, 28px); font-weight:800; letter-spacing:1px}
.trend{font-size:14px; margin: 0 6px 0 6px; color:var(--muted)}
.pair{color:var(--muted); font-size: clamp(11px, 1.6vw, 12px)}
.pair-inline{display:none}
.price{font-size: clamp(18px, 4.4vw, 40px); font-weight:900; line-height:1.1}
.row .price{min-width:0; flex:1 1 auto; white-space:nowrap}
@media (max-width: 420px){
  .row .price{white-space:normal; line-height:1.1}
  .row .delta{flex-basis: 100%; white-space:normal; overflow:visible; text-overflow:clip}
}
.delta{font-weight:700; white-space:normal; overflow:visible; text-overflow:clip}
.delta.up{color:var(--up)}
.delta.down{color:var(--down)}
.kpis{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px}
.kpi{background:#0b0f16; border-radius:12px; padding:8px 10px}
.kpi .label{color:var(--muted); font-size:12px}
.kpi .value{font-weight:700; font-size:14px; margin-top:2px; min-width:0; overflow:hidden; text-overflow:ellipsis}
.book{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px}
.book .value{min-width:0; overflow:hidden; text-overflow:ellipsis}
.badge{font-size:11px; padding:4px 8px; border-radius:999px; background:#0d121a; color:var(--muted);}
canvas.spark{width:100%; height:56px; border-radius:10px; background:#0b0f16; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06)}
/* Chart tooltip */
.chart-tip{position:fixed; pointer-events:none; background:#0b0f16; color:#e6e6e6; border:1px solid rgba(255,255,255,.12); border-radius:8px; padding:6px 8px; font-size:12px; box-shadow:0 8px 24px rgba(0,0,0,.35); z-index:10000}
.chart-tip[hidden]{display:none}
.trade{display:flex; gap:10px; align-items:center; font-size:13px; color:var(--muted); flex-wrap:wrap; row-gap:4px}
.trade > span{min-width:0}
.pill{padding:4px 8px; border-radius:8px; font-weight:700}
.pill.buy{background: rgba(0,200,83,.12); color: var(--up)}
.pill.sell{background: rgba(255,59,48,.12); color: var(--down)}
/* USDT news mode */
.usdt-news{display:none}
.tile.usdt-news-mode .usdt-news{display:block}
.tile.usdt-news-mode .price,
.tile.usdt-news-mode .delta,
.tile.usdt-news-mode .kpis,
.tile.usdt-news-mode .book,
.tile.usdt-news-mode .trade{display:none}
.headline{background:#0b0f16; border-radius:12px; padding:10px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);}
.headline.multi{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:10px}
.headline .hcol{min-width:0}
.headline .source{font-size:12px; color:var(--muted)}
.headline .title{margin-top:6px; font-weight:800}
.news-controls{display:flex; justify-content:flex-end; margin-top:8px}
@media (max-width: 520px){ .headline.multi{grid-template-columns: repeat(2, minmax(0,1fr));} }
@media (max-width: 360px){ .headline.multi{grid-template-columns: 1fr;} }
/* tile footer */
.tile-foot{display:flex; align-items:center; justify-content:space-between; margin-top:auto; gap:10px}
.pair-foot{max-width:60%; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
.aud-controls{display:flex; gap:8px}
footer{padding:8px 14px; color:var(--muted); display:flex; justify-content:space-between; align-items:center; border-top:1px solid rgba(255,255,255,.06)}
.info{display:flex; flex-direction:column; gap:6px; align-items:flex-start}
.wx-box{background:#0b0f16; color:#d1d7e0; border-radius:10px; padding:6px 10px; font-size:13px; line-height:1; box-shadow: inset 0 0 0 1px rgba(255,255,255,.05)}
.wx-city{font-weight:700; margin-right:8px; color:#cbd5e1}
.wx-temp{font-weight:800}
.marquee{position:relative; white-space:nowrap; overflow:hidden}
.marquee::before, .marquee::after{content:""; position:absolute; top:0; bottom:0; width:56px; z-index:1; pointer-events:none}
.marquee::before{left:0; background:linear-gradient(90deg, var(--bg), transparent)}
.marquee::after{right:0; background:linear-gradient(-90deg, var(--bg), transparent)}
.tape-track{position:relative; display:flex; gap:64px; align-items:center; will-change:transform; animation: tape-scroll var(--tape-speed, 40s) linear infinite}
.run{display:inline-flex; gap:24px; align-items:center; padding-left:24px}
.tick{display:inline-flex; gap:10px; align-items:center; font-weight:700}
.sym{color:#d1d7e0; font-size:13px; letter-spacing:.4px}
.pri{font-size:14px}
.pri.blink{border-radius:6px; padding:2px 6px}
.pri.blink.up{animation: blinkUp 1.2s ease-in-out infinite; color: var(--up)}
.pri.blink.down{animation: blinkDown 1.2s ease-in-out infinite; color: var(--down)}
.pri.blink.flat{animation: blinkFlat 1.8s ease-in-out infinite; color: #cbd5e1}
/* Blink for main tile price */
.price.blink.up{animation: blinkUp 1.2s ease-in-out infinite; color: var(--up); text-shadow:0 0 8px rgba(0,200,83,.25)}
.price.blink.down{animation: blinkDown 1.2s ease-in-out infinite; color: var(--down); text-shadow:0 0 8px rgba(255,59,48,.25)}
.price.blink.flat{animation: blinkFlat 1.8s ease-in-out infinite; color: #cbd5e1}
/* Flash effect on tile when price changes */
.tile.flash-up{animation: flashUp .8s ease-out}
.tile.flash-down{animation: flashDown .8s ease-out}
@keyframes flashUp{0%{box-shadow:0 0 0 0 rgba(0,200,83,.28), inset 0 0 0 1px rgba(255,255,255,.06)}100%{box-shadow:0 0 0 0 rgba(0,200,83,0), inset 0 0 0 1px rgba(255,255,255,.04)}}
@keyframes flashDown{0%{box-shadow:0 0 0 0 rgba(255,59,48,.28), inset 0 0 0 1px rgba(255,255,255,.06)}100%{box-shadow:0 0 0 0 rgba(255,59,48,0), inset 0 0 0 1px rgba(255,255,255,.04)}}
@media (prefers-reduced-motion: reduce){.tile.flash-up,.tile.flash-down{animation:none}}
/* Strong swing edge: subtle border glow when >1% move in um tick */
.tile.swing-up{box-shadow:0 0 0 0 rgba(0,200,83,.35), 0 0 24px rgba(0,200,83,.12), inset 0 0 0 1px rgba(255,255,255,.05)}
.tile.swing-down{box-shadow:0 0 0 0 rgba(255,59,48,.35), 0 0 24px rgba(255,59,48,.12), inset 0 0 0 1px rgba(255,255,255,.05)}
@keyframes blinkUp{0%,100%{background:transparent}50%{background:rgba(0,200,83,.18)}}
@keyframes blinkDown{0%,100%{background:transparent}50%{background:rgba(255,59,48,.18)}}
@keyframes blinkFlat{0%,100%{background:transparent}50%{background:rgba(255,255,255,.08)}}
@media (prefers-reduced-motion: reduce){.pri.blink.up,.pri.blink.down,.pri.blink.flat,.price.blink.up,.price.blink.down,.price.blink.flat{animation:none}.tape-track{animation:none !important}}
.sig.up{color:var(--up)}
.sig.down{color:var(--down)}
.sep{opacity:.5; color:var(--muted)}
@keyframes tape-scroll{to{transform:translateX(calc(-1 * var(--tape-distance, 0px)))}}
@media (min-height: 800px){ canvas.spark{height:72px} }
/* Diagnostics */
.diag{position:fixed; right:8px; bottom:8px; background:#0b0f16; color:#d1d7e0; border-radius:10px; padding:10px 12px; box-shadow:0 8px 24px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.06); max-width:min(90vw, 420px); z-index:10}
.diag-head{display:flex; align-items:center; justify-content:space-between; gap:8px}
.diag-content{margin-top:8px; font-size:12px; line-height:1.5}
.diag-opt{display:flex; gap:8px; align-items:center; margin-top:6px}
.btn{all:unset; cursor:pointer; padding:4px 8px; border-radius:8px; background:#1a202c}
.diag-toggle{position:fixed; right:8px; bottom:8px; width:36px; height:36px; border-radius:50%; border:none; background:#0d121a; color:#cbd5e1; box-shadow:0 4px 16px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.06); cursor:pointer; z-index:11}
/* PWA badge */
.pwa-badge{display:inline-block; margin-top:4px; font-size:11px; padding:4px 8px; border-radius:999px; background:#0d121a; color:#9ee493; border:1px solid rgba(255,255,255,.08)}
.pwa-badge[hidden]{display:none !important}
/* LIVE badge */
.live-badge{display:inline-block; font-size:12px; font-weight:800; letter-spacing:.6px; padding:6px 10px; border-radius:999px; background:#210a0a; color:#ff6b6b; border:1px solid rgba(255,107,107,.35); box-shadow:0 0 0 0 rgba(255,107,107,.35); animation: livePulse 1.8s ease-in-out infinite}
@keyframes livePulse{0%{box-shadow:0 0 0 0 rgba(255,107,107,.35)}70%{box-shadow:0 0 0 10px rgba(255,107,107,0)}100%{box-shadow:0 0 0 0 rgba(255,107,107,0)}}
@media (prefers-reduced-motion: reduce){.live-badge{animation:none}}
/* noscript */
.noscript-warning{padding:12px; background:#1a202c; color:#e8e6e3; text-align:center}

/* Responsive guards */
@media (max-width: 360px){
  .kpi .label{font-size:11px}
  .kpi .value{font-size:13px}
  .trade{font-size:12px}
}

/* Install Banner */
.install-banner{position:fixed; left:16px; right:16px; bottom:16px; z-index:1000; background:#0b0f14e6; border:1px solid rgba(255,255,255,.08); border-radius:12px; backdrop-filter: blur(8px); box-shadow:0 8px 24px rgba(0,0,0,.35);}
.install-banner[hidden]{display:none}
.install-banner .ib-content{display:flex; gap:12px; align-items:center; justify-content:space-between; padding:12px 14px;}
.install-banner .ib-text{color:#e8e6e3; font-size:14px; line-height:1.3;}
.install-banner .ib-actions{display:flex; gap:8px;}
.install-banner button{background:#161b22; color:#e8e6e3; border:1px solid rgba(255,255,255,.12); padding:8px 12px; border-radius:8px; cursor:pointer}
.install-banner button.primary{background:#1f6feb; border-color:#388bfd; color:white}
.install-banner button:hover{filter:brightness(1.05)}
.install-banner button:active{transform:translateY(1px)}
@media (max-width:560px){ .install-banner .ib-content{flex-direction:column; align-items:stretch} .install-banner .ib-actions{justify-content:flex-end} }

/* Update Banner */
.update-banner{position:fixed; left:16px; right:16px; bottom:84px; z-index:1000; background:#0b0f14e6; border:1px solid rgba(255,255,255,.08); border-radius:12px; backdrop-filter: blur(8px); box-shadow:0 8px 24px rgba(0,0,0,.35);}
.update-banner[hidden]{display:none}
.update-banner .ub-content{display:flex; gap:12px; align-items:center; justify-content:space-between; padding:12px 14px;}
.update-banner .ub-text{color:#e8e6e3; font-size:14px; line-height:1.3;}
.update-banner .ub-actions{display:flex; gap:8px;}
.update-banner button{background:#161b22; color:#e8e6e3; border:1px solid rgba(255,255,255,.12); padding:8px 12px; border-radius:8px; cursor:pointer}
.update-banner button.primary{background:#1f6feb; border-color:#388bfd; color:white}
.update-banner button:hover{filter:brightness(1.05)}
.update-banner button:active{transform:translateY(1px)}
@media (max-width:560px){ .update-banner .ub-content{flex-direction:column; align-items:stretch} .update-banner .ub-actions{justify-content:flex-end} }

/* Markets page cards */
.back{all:unset; cursor:pointer; padding:10px 14px; border-radius:12px; background:#1a202c; color:#e6e6e6; font-weight:600}
.clock{background: var(--card); border-radius:18px; padding:18px; position:relative; box-shadow: 0 8px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.04); display:flex; flex-direction:column; gap:10px; min-height: 140px;}
.clock h2{margin:0; font-size: clamp(16px, 2.4vw, 18px)}
.clock .now{font-size: clamp(20px, 4vw, 28px); font-weight:800}
.clock .sess{margin-top:4px; font-size:13px; color:var(--muted)}
.legend{font-size:12px; color:var(--muted)}
.open{color:var(--up); font-weight:800}
.closed{color:var(--down); font-weight:800}

/* iOS Install modal */
.ios-modal[hidden]{display:none}
.ios-modal{position:fixed; inset:0; z-index:1100; display:grid; place-items:center}
.ios-backdrop{position:absolute; inset:0; background:rgba(0,0,0,.45); backdrop-filter: blur(6px)}
.ios-box{position:relative; z-index:1; background:#0b0f16; color:#e6e6e6; border-radius:12px; padding:14px; box-shadow:0 10px 30px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.08); width:min(92vw, 420px)}
.ios-head{display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px}
.ios-steps{margin:0; padding-left:18px; color:#cbd5e1}
